No	区分	分類	IF概要	機能	新規/既存	関連資料	参考機能	連携タイミング	全体／差分	項目	連携データ範囲	データ利用機能その１	データ利用機能その２	データ利用機能その３
1	バイタルAWS→HDB	CSV	"マイページ情報連携csv
（汎用的な情報連携csvとする可能性あり）"	マイページ情報アップロードバッチ	新規	-	\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\バイタル測定機能\02.設計書\05_外部IF\01_AWS-HDB\バイタル連携データCSV_Fitbit.doc	１日１回	差分	"■ヘッダ
・ファイル種別
■データ
・ドメインCD
・エリアCD
・HDBキー
・カテゴリ
・値"	前回連携以降個人が更新した全てのマイページ情報	"イベントトップ
ランキング表示時の個人のアイコン、ニックネーム表示"		
2	バイタルAWS→HDB	CSV	歩数情報連携csv	バイタル情報アップロードバッチ	新規	-		１時間に１回	差分	"■ヘッダ
・ファイル種別
■データ
・ドメインCD
・エリアCD
・HDBキー
・測定日時（機器）
・測定値（機器）
・測定日時（手入力）
・測定値（手入力）"	個人のログイン時から過去30日以内？の歩数情報	"イベントトップ
歩数連携時点でのランキング算出・歩数表示"	"イベント対象者の一覧
歩数連携時点での歩数表示"	
3	バイタルAWS→HDB	CSV	バイタル情報連携csv	バイタル情報アップロードバッチ	新規	-		１日１回	差分	"■ヘッダ
・ファイル種別
■データ
・ドメインCD
・エリアCD
・HDBキー
・測定項目
・測定日時
・測定値"	個人のログイン時から過去30日以内？の各バイタル情報	"バイタルデータの出力
個人ごと、項目ごとのバイタルデータの出力"		
4	バイタルAWS→HDB	API	ログイン認証API	ログイン認証API	既存	\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\業務関係\設計書\02_業務\05_外部連携\AWSforHDB\20_IF仕様書\AWS→HDB\Health Data Bank2.0 バイタル連携API_I／F（HDB）仕様書_STEP6.docx		ユーザがログインすれば連携	ー	"・クライアントID
・クライアントシークレット
・IDトークン"	個人がログイン時に入力したユーザ情報	"ログイン認証
ユーザの認証処理"	-	
5	バイタルAWS→HDB	API	ログイン認証API(転籍用)	ログイン認証API	既存	\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\業務関係\設計書\02_業務\05_外部連携\AWSforHDB\20_IF仕様書\AWS→HDB\Health Data Bank2.0 バイタル連携API_I／F（HDB）仕様書_STEP6.docx	-	検討中	ー	"・クライアントID
・クライアントシークレット
・IDトークン"	個人が転籍のデータ移行依頼時に入力したユーザ情報	"転籍用ログインAPI（アプリ側）
転籍者のキー情報の付け替え"		
6	HDB→バイタルAWS	CSV	権限連携csv	権限連携バッチ	既存	"\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\業務関係\設計書\02_業務\01_共通
　└CMN0960_バイタル権限情報の連携バッチ.docx
　└CMN0960_利用者権限連携データCSV.doc"	-	１日１回	差分	"■ヘッダ
・ファイル種別
■データ
・ドメインCD
・エリアCD
・HDBキー
・HDB利用権限
・binah.ai SDK利用権限
・パルスサーベイ利用権限
・削除フラグ
・利用権限種別"	前回連携からの差分の権限情報	"アプリタスクバー
利用権限によるメニューの表示制御"		
7	HDB→バイタルAWS	CSV	Push通知対象者連携csv	Push通知対象者連携バッチ	新規	-	\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\業務関係\設計書\02_業務\01_共通\CMN0970_プッシュ通知依頼バッチ.docx	〇時間に1回	差分	"■ヘッダ
・お知らせ名
・お知らせ内容
・通知日時
・遷移先画面
・お知らせID（詳細画面に遷移する場合）
■データ
・ドメインCD
・エリアCD
・HDBキー"	前回連携以降のPush通知情報	"Push通知
個人へのPush通知"		
8	HDB→外部	API	ポイント交換情報連携API	ポイント交換情報連携API	新規	dポイント進呈API仕様書_1.15版.pdf	-	個人がポイントの交換を申し込んだ際	ー	"・個人を特定する情報
　　dポイントクラブ会員番号
・取引先営業日
・取引先発生年月日
・取引先発生時刻
・チャネル区分
・取引先店舗コード
・取引番号
・取引ポイント
　　ポイント情報
　　　ポイント種別
　　　ポイント色区分
　　ポイント数"	個人がポイントの交換を申し込んだ際の情報	"ポイント付与
個人が入力した交換ポイント数に従ってdポイントへの交換を行う。"		
9	HDB（内部IF）	CSV	ポイント付与csv	ポイント付与	新規	-	"\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\業務関係\設計書\02_業務\01_共通\CMN1210_面接記録一括登録バッチ.docx
※処理の流れは参考になるかも"	スタッフがファイル送信した際	ー	"■ヘッダ
・ドメインCD
・エリアCD
■データ
・第一キー
・生年月日
・ポイント内容
・ポイント数"	スタッフが作成するcsv内容に従う。	"ポイント表示
CSVアップロードで付与されたポイント履歴として表示される。"	"ポイントの一覧表示（ダイジェスト）
CSVアップロードで付与されたポイント履歴として表示される。"	"ポイントデータ出力バッチ
CSVアップロードで付与されたポイント履歴として出力される。"
10	HDB（内部IF）	CSV	バイタル出力csv	バイタルデータ出力バッチ	既存	\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\業務関係\設計書\02_業務\01_共通\CMN1070_ｄヘルスケアグラフ集計バッチ.doc	-	ユーザがファイル出力を依頼した際	ー	"・個人情報
　（第一キー、氏名、性別、生年月日、集合等）
・測定日時
・バイタル項目
・測定値"	"画面での設定条件に従う。
条件の制約は要検討（期間指定等）"	-		
11	HDB（内部IF）	CSV	ポイント出力csv	ポイントデータ出力バッチ	新規	-	"\\172.16.202.11\shared\@Documents\健診機関版ヘルスデータバンク開発\秘密_ＨＩ担当\業務関係\設計書\02_業務\01_共通\CMN1200_労基署集計バッチ（特殊健診）.docx
※csv出力の処理は参考になるかも？"	ユーザがファイル出力を依頼した際	ー	"・個人情報
　（第一キー、氏名、性別、生年月日、集合等）
・ポイント属性
・ポイント内容
・ポイント数"	"画面での設定条件に従う。
条件の制約は要検討（期間指定等）"	-		
12	新アプリ→バイタルAWS	API	デバイス情報登録・更新	デバイス情報・登録API	新規			１日１回		"■リクエスト
・クライアントID
・デバイスID (初回呼び出し時は省略)
・デバイス情報 (バージョンなど)
・Push通知用のデバイストークン
■レスポンス
・デバイスID
・ログイン状態
・利用権限配列
・ミッション情報
・移行データ情報"	"新アプリ起動時
または
フォアグラウンドに遷移した時"			
13	新アプリ→バイタルAWS	API	ログイン	ログイン連携API	新規			アプリ起動時、および、ログアウト後		"■リクエスト
・クライアントID
・デバイスID
・リダイレクトURI
・ステート
■レスポンス
・認可コード
・ステート"	ログイン時			
14	新アプリ→バイタルAWS	API	ログアウト	ログイン連携API	新規					"■リクエストヘッダ
・アクセストークン
■リクエスト
・クライアントID
・デバイスID
・ユーザーID
■レスポンス
無し"	ログアウト時			
15	新アプリ→バイタルAWS	API	トークン取得	トークン取得API	新規			アクセストークンの期限切れ時		"■リクエストヘッダ
・Basic認証
■リクエスト
・クライアントID
・grant_type
・リフレッシュトークン
■レスポンス
・アクセストークン
・アクセストークンの有効期限
・リフレッシュトークン
・ユーザーID
・利用権限配列
・ミッション情報
・移行データ"	"ログイン後の認可コードからアクセストークン取得
リフレッシュトークンからアクセストークン取得
"			
16	新アプリ→バイタルAWS	API	dヘルスからの移行データ取得	移行データ取得API	新規			移行データが存在する場合		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
・取得開始インデックス
・取得する鵜
■レスポンスヘッダ
・移行データ取得結果
■ボディ
CSV形式の移行データ"	移行データがある場合			
17	新アプリ→バイタルAWS	API	転籍用ログイン	転籍用ログインAPI	新規			転籍時		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
・デバイスID
・リダイレクトURI
・ステート
■レスポンス
・転籍前のユーザーID
・ステート"	ユーザーが転籍し、バーガーメニューの転籍データ移行タップ時			
18	新アプリ→バイタルAWS	API	Single Sign On	Single Sign On API	新規			HDB側の画面をWebViewで表示時		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
・遷移先画面名称
■レスポンス
・個人サイトページのURL"	各種機能でHDB側のWebページを表示する時			
19	新アプリ→バイタルAWS	API	Healthデータ登録	Health Connect/HealthKit のデータアップロードAPI	新規			１時間に１回		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
・Healthデータ配列
■レスポンス
なし"	Health Connect または HealthKit からデータ取得後			
20	新アプリ→バイタルAWS	API	マイデータ登録	マイページ登録API	新規			"マイページ更新時
目標設定時
目標達成時"		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
・マイページ情報(ニックネーム、アイコン)
・目標情報
・目標達成状況
■レスポンス
なし"	"ユーザーが新アプリで以下の操作を実施したタイミング
・マイページ更新
・目標設定
・目標達成"			
21	新アプリ→バイタルAWS	API	アプリDBバックアップ	新アプリDBバックアップ・リストアAPI	新規			機種変時		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
・マルチパートでバックアップデータ
■レスポンス
・パスワード
・有効期限"	機種変前の端末で、ユーザーがバーガーメニューのアプリDBバックアップをタップ時			
22	新アプリ→バイタルAWS	API	アプリDBリストア	新アプリDBバックアップ・リストアAPI	新規			機種変時		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
・パスワード
■レスポンス
・リストアデータ"	機種変後の端末で、ユーザーがバーガーメニューのアプリDBリカバリをタップ時			
23	新アプリ→バイタルAWS	API	マイデータ取得	マイページに登録したニックネームとアイコンを取得する。	新規			ユーザーが新アプリで以下の操作を実施したタイミング・マイページ遷移		"■リクエストヘッダ
・アクセストークン
■リクエスト
・ユーザーID
■レスポンス
・マイページ情報(ニックネーム、アイコン)
・目標情報
・目標達成状況"	ユーザーが新アプリで以下の操作を実施したタイミング・マイページ遷移			
24	新アプリ→バイタルAWS	API	認証状態確認API	アクセストークンの有効性確認とユーザー情報取得	新規			アプリ起動時の自動ログイン確認						
25	新アプリ→バイタルAWS	API	バイタルデータ一括登録API	複数のバイタルデータを一括で登録	新規			オフライン時に蓄積したデータの一括送信						
26	新アプリ→バイタルAWS	API	目標情報取得API	ユーザーの目標設定情報を取得	新規			目標達成状況の確認、グラフ表示						
27	新アプリ→バイタルAWS	API	ミッション詳細取得API	個別ミッションの詳細情報を取得	新規			ミッション詳細画面表示						
28	新アプリ→バイタルAWS	API	ミッション進捗更新API	ミッションの進捗状況を更新	新規			ミッション達成時の記録						
29	新アプリ→バイタルAWS	API	通知設定取得API	ユーザーの通知設定（種別ごとのON/OFF）を取得	新規			通知設定画面の初期表示						
30	新アプリ→バイタルAWS	API	通知設定更新API	通知種別ごとのON/OFF設定を更新	新規			通知設定画面での設定変更						
31	新アプリ→バイタルAWS	API	歩数ランキング取得API	期間別（日/週/月）の歩数ランキングを取得	新規			ランキング画面表示						
32	新アプリ→バイタルAWS	API	マイページ情報取得API	ユーザーのニックネーム、アイコン等を取得	新規			マイページ画面の表示						
33	新アプリ→バイタルAWS	API	お知らせ一覧取得API	アプリ向けお知らせの一覧を取得	新規			お知らせ画面表示						
34	新アプリ→バイタルAWS	API	移行進捗確認API	転籍データ移行の進捗状況を確認	新規			移行状況の表示
