# サービス提供要求分析書
## （HDBアプリケーションサービス）

**文書管理番号：HDB-SRQ-002**

**第1.0版　2025年01月07日**

**(株)NTTデータ　デジタル本部　ヘルスケア担当**

---

## 改訂履歴
| 版数 | 制改定日付 | 変更箇所 | 変更理由 | 変更内容 | 変更者 | 承認者 |
|------|-----------|---------|---------|---------|--------|--------|
| 1.0  | 2025/01/07 | 新規作成 | 初版作成 | 全体 | システム設計者 | - |

---

## 目次
1. [はじめに](#1-はじめに)
2. [運用要求](#2-運用要求)
3. [参考資料一覧](#3-参考資料一覧)

---

## 1. はじめに

### 1.1. 本要求分析書の目的
要求分析フェーズで検討した運用・保守に必要となる要求や作業を、漏れなく、正確にサービス提供検討作業担当に引き継ぎ、保守・運用作業に落とし込む為のインプット情報を提供する。

HDBアプリケーション（React Native 0.80.0ベース）の実際の構成・機能を踏まえ、お客様要求事項に沿ったサービス提供を行う体制および仕組みを構築し、安定的にサービスを提供する事を目的とする。

## 2. 運用要求
当サービス提供組織が実施するサービス提供に係わる計画を以下に示す。

### 2.1. サービス提供範囲

#### 2.1.1. 対象システム概要
サービス提供の対象となるシステム概要を以下に示す。

**① サービス一覧**
| サービス名称 | 提供内容 |
|-------------|---------|
| HDBモバイルアプリサービス | React Nativeベース健康データ管理アプリの運用・保守 |

**② お客様**
| 項番 | お客様 | 連絡先 | 備考 |
|------|--------|--------|------|
| 1 | エンドユーザー（一般利用者） | アプリ内問い合わせ | iOS/Androidユーザー |
| 2 | 企業契約先 | 法人窓口 | 企業健康管理部門 |

**③ サービスの概要**
| 項番 | サービスメニュー | サービス名 | 提供内容 | 備考 |
|------|----------------|-----------|---------|------|
| 1 | モバイルアプリ運用 | HDBアプリ24時間監視 | iOS/Androidアプリの稼働監視・障害対応 | Firebase Crashlytics使用 |
| 2 | データ管理 | バイタルデータ管理 | SQLite暗号化DB、Health Connect連携 | react-native-sqlite-2使用 |
| 3 | 認証・セキュリティ | セキュア認証管理 | Keychain/Keystore、AES256暗号化 | react-native-keychain使用 |
| 4 | ユーザーサポート | アプリサポート | 操作問い合わせ、障害報告対応 | 日本語対応（多言語準備中） |

#### 2.1.2. 対象システム構成
サービス提供対象となるシステムの構成概要を以下に示す。

**① システム構成概要図**
```
[クライアント層]
├─ iOS App（React Native 0.80.0）
│  ├─ iPhone（iOS16以降サポート）
│  └─ iPad（レスポンシブ対応）
└─ Android App（React Native 0.80.0）
   ├─ スマートフォン（Android10以降サポート）
   └─ タブレット（レスポンシブ対応）

[アプリケーション層]
├─ React Navigation（Stack + Drawer）
├─ Health Connect（Android）・HealthKit（iOS）連携
├─ Keychain（iOS）・Keystore（Android）認証
└─ SQLite2暗号化ローカルDB

[データ連携層]
├─ HDB Webシステム（WebView）
├─ Push通知（@notifee/react-native）
└─ バイタルデータ同期

[監視・分析層]
├─ Firebase Crashlytics（クラッシュ監視）
├─ デバッグメニュー（開発支援）
└─ アクセシビリティ（VoiceOver/TalkBack）
```

**② サービス提供概要図**
```
[エンドユーザー] 
    ↓（アプリ利用）
[モバイルアプリ（iOS/Android）]
    ↓（Crashlytics）
[Firebase監視センター] ←→ [運用チーム]
    ↓（アラート）          ↓
[24時間監視] ←→ [技術サポート]
```

#### 2.1.3. システム運用・保守作業項目
実際のHDBアプリ構成に基づく運用・保守作業項目を以下に示す。

| アクティビティ | 作業 | 作業内容概要 | HDB実装固有要件 |
|---------------|------|-------------|----------------|
| **システム運用** | | | |
| | アプリ監視 | Firebase Crashlyticsによるクラッシュ監視 | **リアルタイムクラッシュ検知・通知** |
| | 性能監視 | メモリ200MB以下、CPU50%以下、起動3秒以内監視 | **非機能要求.tsvの性能指標遵守** |
| | データベース管理 | SQLite暗号化DB、AES256による保護 | **react-native-sqlite-2の暗号化機能** |
| | 認証基盤管理 | Keychain/Keystoreベース認証、生体認証連携 | **react-native-keychain管理** |
| | Health Connect連携監視 | Android Health Connect API連携状況監視 | **react-native-health-connect状態監視** |
| | プッシュ通知管理 | @notifee/react-nativeによる通知配信 | **iOS/Android別通知管理** |
| | WebView連携監視 | HDB Webシステムとの連携状況監視 | **react-native-webview接続監視** |
| | セキュリティ監視 | OWASP Mobile Top 10対策状況確認 | **定期セキュリティスキャン実施** |
| **保守** | | | |
| | React Native保守 | バージョン0.80.0の安定運用、依存ライブラリ更新 | **package.json記載の34ライブラリ管理** |
| | OS対応保守 | iOS16以降、Android10以降サポート継続 | **新OS版リリース3ヶ月以内対応** |
| | アクセシビリティ保守 | VoiceOver/TalkBack、JIS X 8341-3 AA準拠 | **スクリーンリーダー対応維持** |
| | 多言語化保守 | 日本語ベース、英語・中国語対応準備 | **国際化リソース管理** |

#### 2.1.4. 制約条件とリスク
実際のHDBアプリの制約条件とリスクを以下に示す。

| 項番 | 制約内容 | 制約の原因 | 影響を受ける部分 | 影響内容とリスク | 対応策 | 備考 |
|------|---------|-----------|----------------|------------------|--------|------|
| 1 | React Native依存 | フレームワーク選択 | アプリ全体 | RN脆弱性・バージョン更新リスク | 定期的なバージョンアップ、セキュリティパッチ適用 | 重要 |
| 2 | 端末依存機能制限 | Health Connect/HealthKit | データ連携 | デバイス・OS別機能差異 | プラットフォーム別実装、フォールバック機能 | 高リスク |
| 3 | ルート化/JB検出困難 | 技術的制約 | セキュリティ | 改ざん・不正利用リスク | 警告表示のみ（ブロック不可） | 中リスク |
| 4 | SQLite性能限界 | ローカルDB制約 | データ処理 | 大量データ時の性能劣化 | データ分割、定期クリーンアップ | 中リスク |
| 5 | アプリストア審査 | プラットフォーム制約 | リリース | 審査遅延・リジェクトリスク | 事前審査ガイドライン確認 | 中リスク |

### 2.2. サービスレベル目標
HDB非機能要求.tsvに基づくサービスレベル目標を以下に示す。

#### 2.2.1. サービスレベル一覧
実際の非機能要求に基づくサービスレベル目標を以下に示す。

**① サービスレベル目標**
| 種別 | 作業項目 | メトリクス(指標) | サービスレベル目標 | **運用コスト影響** |
|------|---------|------------------|-------------------|----------------|
| **性能・拡張性** | | | | |
| | アプリ起動時間 | 起動時間 | **初回3秒以内90%ile、2回目以降1秒以内90%ile** | 基準 |
| | 画面遷移 | レスポンス時間 | **主要画面0.5秒以内90%ile、WebView3秒以内** | 基準 |
| | データ処理 | 表示時間 | **バイタルデータ1000件2秒以内** | 基準 |
| | リソース効率 | CPU・メモリ | **CPU50%以下、メモリ200MB以下** | 基準 |
| | バッテリー効率 | 消費量 | **1時間連続5%以内、バックグラウンド最小化** | 基準 |
| | 通信効率 | データ量 | **1日平均50MB以内** | 基準 |
| **可用性** | | | | |
| | 稼働率 | アプリ稼働率 | **24時間365日稼働、オフライン機能併用** | **月額+20万円** |
| | 目標復旧時間 | RTO | **アプリ障害2時間以内復旧** | **月額+30万円** |
| | エラー処理 | 障害対応 | **予期せぬエラー時クラッシュ防止** | **月額+15万円** |
| | データ保全 | バックアップ | **強制終了時データ自動保存** | 基準 |
| | オフライン対応 | 継続性 | **通信断時キャッシュで基本操作継続** | 基準 |
| **セキュリティ** | | | | |
| | 認証 | ユーザー認証 | **HDB準拠認証、初回本人認証** | **月額+25万円** |
| | 通信暗号化 | TLS | **TLS1.3、証明書ピンニング** | **月額+10万円** |
| | データ暗号化 | 保存データ | **AES256暗号化、Keychain/Keystore** | **月額+15万円** |
| | セキュリティ診断 | 脆弱性対策 | **OWASP Mobile Top 10準拠定期診断** | **年額200万円** |
| **運用・保守性** | | | | |
| | 開発環境 | 環境構築 | **開発・ステージング・本番環境** | **月額+40万円** |
| | テスト環境 | 実機テスト | **専用テスト環境、実機テスト** | **月額+30万円** |
| | コード品質 | 品質管理 | **ESLint・Prettier、TypeScript strict** | 基準 |
| | ログ出力 | 運用監視 | **重要操作・エラー・警告ログ、個人情報除外** | **月額+20万円** |
| | クラッシュ監視 | Firebase監視 | **Crashlytics自動収集・分析** | **月額+25万円** |
| | OS対応 | バージョンアップ | **新OS版3ヶ月以内対応、3世代サポート** | **年額300万円** |
| **ユーザビリティ** | | | | |
| | UI/UX | デザイン | **Apple HIG・Material Design準拠** | 基準 |
| | アクセシビリティ | 準拠レベル | **JIS X 8341-3 AAレベル、ダークモード** | **月額+10万円** |
| | 多言語対応 | 国際化 | **日本語ベース、英語・中国語準備** | **月額+35万円** |
| | 操作性 | 片手操作 | **画面下部操作、リーチャビリティ考慮** | 基準 |

### 2.3. サービス提供体制
HDBアプリの技術構成に基づく実施体制を以下に示す。

#### 2.3.1. 体制図
React Native・モバイルアプリ特化の体制を以下に示す。

```
[お客様（企業契約・エンドユーザー）]
    ↓
[サービスマネージャー]
    ↓
[フロントサポート（営業時間）]
├─ アプリサポートデスク（日本語対応）
├─ Firebase監視センター（24時間）
└─ 1次障害対応
    ↓
[技術チーム]
├─ React Native開発者
├─ iOS専門エンジニア
├─ Android専門エンジニア
└─ セキュリティエンジニア
    ↓
[外部連携]
├─ Firebase/Google Cloud
├─ Apple Developer Support
└─ Google Play Console Support
```

#### 2.3.2. 体制一覧
HDBアプリの技術スタックに対応した体制を以下に示す。

| 項番 | 対応者 | 役割 | **要員数** | **必要スキル** |
|------|--------|------|-----------|-------------|
| 1 | サービスマネージャー | 全体統括、お客様窓口 | **1名** | プロジェクト管理、ヘルスケアIT |
| 2 | アプリサポートデスク | エンドユーザー問い合わせ | **2名** | モバイルアプリ知識、日本語対応 |
| 3 | Firebase監視担当 | Crashlytics監視、アラート対応 | **3名** | Firebase、モバイルアプリ監視 |
| 4 | React Native開発者 | アプリ保守、バグ修正 | **2名** | **RN 0.80.0、TypeScript 5.0.4** |
| 5 | iOS専門エンジニア | iOS固有問題、HealthKit連携 | **1名** | **iOS16+、Swift、HealthKit** |
| 6 | Android専門エンジニア | Android固有問題、Health Connect | **1名** | **Android10+、Kotlin、Health Connect** |
| 7 | DB専門エンジニア | SQLite暗号化、データ管理 | **1名** | **react-native-sqlite-2、暗号化** |
| 8 | セキュリティエンジニア | OWASP対応、暗号化実装 | **1名** | **モバイルセキュリティ、AES256** |
| **合計** | | | **12名** | |

#### 2.3.3. 作業場所
モバイルアプリ開発に適した作業環境を以下に示す。

| 作業 | 施設名 | 住所等 | 備考 |
|------|--------|--------|------|
| React Native開発 | **モバイル開発センター** | 品川区○○ビル8階 | Mac・Windows・実機環境完備 |
| Firebase監視 | **クラウド監視センター** | 同上 | 24時間体制、Firebase専用画面 |
| アプリサポート | **サポートセンター** | 同上 | 営業時間（平日9-18時） |
| 実機テスト | **デバイステストルーム** | 同上 | iPhone・Android実機20台以上 |

#### 2.3.4. 責任分界点
HDBアプリの技術領域に基づく責任分界点を以下に示す。

```
【お客様責任範囲】
├─ エンドユーザー利用指導
├─ 企業契約管理
└─ 業務運用ルール

【NTTデータ責任範囲】
├─ React Nativeアプリ運用・保守
├─ Firebase Crashlytics監視
├─ SQLite暗号化DB管理
├─ セキュリティ（AES256、Keychain/Keystore）
├─ Health Connect/HealthKit連携
└─ アプリストア対応

【プラットフォーム責任範囲】
├─ iOS/Android OS
├─ App Store/Google Play
├─ Firebase/Google Cloud基盤
└─ デバイスハードウェア
```

| 項番 | 責任分界点 | 対応者 | 連絡先 | 備考 |
|------|-----------|--------|--------|------|
| 1 | **React Nativeアプリ** | NTTデータ | 開発センター | RN 0.80.0、JS/TypeScript |
| 2 | **ローカルデータベース** | NTTデータ | DB担当 | react-native-sqlite-2 |
| 3 | **Firebase監視** | NTTデータ→Firebase | Google Support | Crashlytics |
| 4 | **Health Connect連携** | NTTデータ→Google | Google Health | Android専用 |
| 5 | **HealthKit連携** | NTTデータ→Apple | Apple Developer | iOS専用 |
| 6 | **アプリストア** | NTTデータ→各ストア | ストアサポート | 審査・配信 |

#### 2.3.5. 必要スキル一覧
HDBアプリの実装技術に対応したスキルを以下に示す。

| 対応者 | 必要なスキル | **認定資格・経験年数** |
|--------|-------------|---------------------|
| React Native開発者 | ・React Native 0.80.0開発経験<br>・TypeScript 5.0.4上級<br>・JavaScript ES6+<br>・redux等状態管理 | **RN開発3年以上**<br>**TypeScript認定** |
| iOS専門エンジニア | ・iOS16以降対応<br>・Swift・Objective-C<br>・HealthKit API<br>・Keychain管理 | **iOS Developer**<br>**iOS開発5年以上** |
| Android専門エンジニア | ・Android10以降対応<br>・Kotlin・Java<br>・Health Connect API<br>・Keystore管理 | **Android Developer**<br>**Android開発5年以上** |
| DB専門エンジニア | ・SQLite管理・チューニング<br>・react-native-sqlite-2<br>・AES256暗号化<br>・データマイグレーション | **SQLite専門知識**<br>**暗号化技術** |
| セキュリティエンジニア | ・OWASP Mobile Top 10<br>・AES256実装<br>・Keychain/Keystore<br>・モバイルアプリ脆弱性診断 | **CISSP**または**CEH**<br>**モバイルセキュリティ3年以上** |
| Firebase監視担当 | ・Firebase Crashlytics<br>・Google Cloud Console<br>・モバイルアプリ監視<br>・アラート対応 | **Firebase認定**<br>**クラウド監視経験** |

### 2.4. ITサービス管理作業方針／適用範囲
HDBアプリの運用に特化したITサービス管理方針を以下に示す。

| 項番 | アクティビティ | 管理方針と適用範囲 | ツールの導入 | **HDBアプリ固有要件** |
|------|--------------|-------------------|-------------|-------------------|
| 1 | **インシデント管理** | ・Firebase Crashlyticsベースの障害検知<br>・アプリクラッシュの自動通知<br>・エンドユーザー問い合わせ対応 | **Firebase Crashlytics**<br>**Redmine** | ・クラッシュレポート即時分析<br>・React Native特有エラー対応 |
| 2 | **問題管理** | ・React Native依存関係問題<br>・プラットフォーム別根本原因分析<br>・健康データ連携問題管理 | **Firebase Crashlytics**<br>**GitHub Issues** | ・Health Connect/HealthKit問題<br>・SQLite暗号化問題 |
| 3 | **変更管理** | ・React Nativeバージョン更新管理<br>・依存ライブラリ更新管理<br>・アプリストア審査対応 | **GitHub**<br>**Fastlane** | ・RN 0.80.0→新版マイグレーション<br>・package.json管理 |
| 4 | **リリース管理** | ・iOS/Android個別ビルド<br>・アプリストア配信管理<br>・段階的リリース | **Fastlane**<br>**App Store Connect**<br>**Google Play Console** | ・iOS/Android同時リリース<br>・ストア審査期間考慮 |
| 5 | **構成管理** | ・React Native環境管理<br>・依存ライブラリ管理<br>・実機デバイス管理 | **GitHub**<br>**npm/yarn** | ・34ライブラリのバージョン管理<br>・実機テスト環境管理 |
| 6 | **性能管理** | ・アプリ性能監視（起動時間、メモリ、CPU）<br>・Firebase Performance<br>・バッテリー消費監視 | **Firebase Performance**<br>**Xcode Instruments**<br>**Android Profiler** | ・非機能要求.tsv指標監視<br>・Health Connect性能影響 |
| 7 | **セキュリティ管理** | ・OWASP Mobile Top 10対応<br>・依存関係脆弱性管理<br>・AES256暗号化監視 | **npm audit**<br>**Snyk**<br>**OWASP ZAP** | ・react-native-keychainセキュリティ<br>・SQLite暗号化状態監視 |

### 2.5. ITサービス管理支援ツール作成方針

#### ① 支援ツール作成方針
React Nativeモバイルアプリに特化した軽量で実用的なツール選定を行う。コストと機能のバランスを重視し、HDBアプリの実装技術に対応したツールを導入する。

#### ② 支援ツール選定
実際のHDBアプリ技術構成に対応したツールを以下に示す。

| 項番 | 管理支援ツール | 説明 | **月額コスト** | **HDBアプリ対応機能** |
|------|--------------|------|-------------|-------------------|
| 1 | **Firebase Suite** | モバイルアプリ統合管理<br>・Crashlytics（クラッシュ監視）<br>・Performance（性能監視）<br>・Analytics（利用状況分析） | **25万円** | ・React Native完全対応<br>・リアルタイムクラッシュ通知<br>・Health Connect連携監視 |
| 2 | **GitHub Enterprise** | ソースコード管理・CI/CD<br>・React Nativeプロジェクト管理<br>・依存関係監視<br>・セキュリティスキャン | **15万円** | ・package.jsonバージョン管理<br>・npm audit自動実行<br>・TypeScript対応 |
| 3 | **Fastlane** | モバイルアプリ自動化<br>・iOS/Androidビルド自動化<br>・アプリストア自動配信<br>・証明書管理 | **無料** | ・React Native専用設定<br>・両プラットフォーム同時対応 |
| 4 | **Redmine** | 軽量チケット管理<br>・インシデント管理<br>・問い合わせ対応<br>・プロジェクト管理 | **5万円** | ・モバイルアプリ専用カテゴリ<br>・Firebase連携<br>・ユーザー問い合わせ対応 |
| 5 | **Snyk** | セキュリティ脆弱性管理<br>・依存関係スキャン<br>・React Native対応<br>・継続監視 | **20万円** | ・package.json脆弱性監視<br>・React Native特化スキャン |
| 6 | **TestFlight + Google Play Internal Testing** | アプリテスト配信<br>・ベータテスト管理<br>・テスター管理<br>・フィードバック収集 | **無料** | ・内部テスト環境<br>・段階的リリース |

**合計月額ツールコスト：65万円**

## 3. 参考資料一覧
HDBアプリの実装に基づく参考資料を以下に示す。

| 項番 | 参考資料名 | 概要 | 備考 |
|------|-----------|------|------|
| 1 | **HDBApp/package.json** | React Native依存関係定義 | 34ライブラリの管理対象 |
| 2 | **セキュリティ方式概要設計書.md** | HDBアプリセキュリティ詳細設計 | AES256、Keychain/Keystore仕様 |
| 3 | **スマホアプリ単体_非機能要求.tsv** | 性能・セキュリティ要求42項目 | SLA根拠資料 |
| 4 | **CLAUDE.md** | 開発環境・アーキテクチャ情報 | React Native 0.80.0構成 |
| 5 | **React Native 0.80.0 Documentation** | フレームワーク公式ドキュメント | バージョン固有情報 |
| 6 | **Firebase Crashlytics Documentation** | クラッシュ監視実装ガイド | 監視設定詳細 |
| 7 | **OWASP Mobile Top 10 2024** | モバイルアプリセキュリティ基準 | 脆弱性対策ガイドライン |
| 8 | **Apple Human Interface Guidelines** | iOS UI/UX設計基準 | iOS対応必須 |
| 9 | **Android Material Design** | Android UI/UX設計基準 | Android対応必須 |

---

## **実運用コスト見積（実装ベース）**

### **基本運用コスト（月額）**
- **人件費**：12名体制　→　**月額840万円**
- **ツール費用**：Firebase + GitHub等　→　**月額65万円**
- **インフラ費用**：Firebase、実機環境　→　**月額40万円**
- **セキュリティ費用**：診断、監査　→　**月額35万円**

### **合計月額運用コスト：980万円**

### **年間特別費用**
- **OS対応開発**：iOS/Android新版対応　→　**年額300万円**
- **セキュリティ監査**：OWASP診断　→　**年額200万円**
- **実機更新**：最新デバイス購入　→　**年額100万円**

**年間総コスト：1億3,460万円**

---

**【重要な合意事項】**

本サービス提供要求分析書は、HDBアプリの実装技術（React Native 0.80.0、34依存ライブラリ）に基づいて作成しています：

1. **React Native依存リスク**：フレームワーク更新・脆弱性対応必須
2. **プラットフォーム依存**：iOS16+/Android10+サポート、Health Connect/HealthKit
3. **モバイル特化運用**：Firebase監視、アプリストア管理、実機テスト
4. **実装制約**：ルート化検出困難、SQLite性能限界あり
5. **継続コスト**：OS対応、ライブラリ更新、セキュリティ対応

**実装ベース運用コスト：月額980万円（Firebase中心の軽量構成）**

---

**承認欄**

お客様承認：_____________（署名）_____（日付）

NTTデータ承認：_____________（署名）_____（日付）